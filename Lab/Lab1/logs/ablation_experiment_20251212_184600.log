2025-12-12 18:46:00,944 - INFO - ============================================================
2025-12-12 18:46:00,944 - INFO - 实验一：消融实验 - 知识蒸馏模块有效性验证
2025-12-12 18:46:00,944 - INFO - ============================================================
2025-12-12 18:46:00,944 - INFO - 数据集: Grocery_and_Gourmet_Food
2025-12-12 18:46:00,944 - INFO - 随机种子: 0
2025-12-12 18:46:00,944 - INFO - Embedding 维度: 64
2025-12-12 18:46:00,944 - INFO - GNN 层数: 2
2025-12-12 18:46:00,944 - INFO - Lambda_ID: 1.0
2025-12-12 18:46:01,027 - INFO - 设备: cuda
2025-12-12 18:46:01,027 - INFO - 加载数据集: /home/ReChorus/data/Grocery_and_Gourmet_Food/BaseReader.pkl
2025-12-12 18:46:01,173 - INFO - 用户数: 14682, 物品数: 8714
2025-12-12 18:46:01,174 - INFO - Teacher 模型: /home/ReChorus/record/BiGeaR_LightGCN_v2/controlled_stage1_models/BiGeaR_LightGCN_v2__Grocery_and_Gourmet_Food__seed0__lr=0.001__l2=1e-06__emb_size=64__n_layers=2__stage=1.pt
2025-12-12 18:46:01,174 - INFO - 
============================================================
2025-12-12 18:46:01,174 - INFO - Part 1: 训练有蒸馏版本 (use_distillation=True)
2025-12-12 18:46:01,174 - INFO - ============================================================
2025-12-12 18:46:01,174 - INFO - 
============================================================
2025-12-12 18:46:01,174 - INFO - 开始训练 Stage 2 (with_distill)
2025-12-12 18:46:01,174 - INFO - ============================================================
2025-12-12 18:46:08,030 - INFO - 模型参数量: 1497344
2025-12-12 18:46:08,030 - INFO - use_distillation = True
2025-12-12 18:46:08,375 - INFO - 训练前测试: (NDCG@5:0.2430,NDCG@10:0.2820,NDCG@20:0.3111,NDCG@50:0.3525)
2025-12-12 18:46:08,482 - INFO - Optimizer: Adam
2025-12-12 18:46:19,699 - INFO - Epoch 1     loss=0.1952 [11.2 s]	dev=(NDCG@10:0.3391) [0.1 s] *
2025-12-12 18:46:30,452 - INFO - Epoch 2     loss=0.1784 [10.6 s]	dev=(NDCG@10:0.3436) [0.1 s] *
2025-12-12 18:46:41,015 - INFO - Epoch 3     loss=0.1713 [10.4 s]	dev=(NDCG@10:0.3450) [0.1 s] *
2025-12-12 18:46:51,622 - INFO - Epoch 4     loss=0.1655 [10.4 s]	dev=(NDCG@10:0.3473) [0.1 s] *
2025-12-12 18:47:02,321 - INFO - Epoch 5     loss=0.1632 [10.5 s]	dev=(NDCG@10:0.3484) [0.1 s] *
2025-12-12 18:47:12,784 - INFO - Epoch 6     loss=0.1608 [10.3 s]	dev=(NDCG@10:0.3488) [0.1 s] *
2025-12-12 18:47:23,476 - INFO - Epoch 7     loss=0.1599 [10.5 s]	dev=(NDCG@10:0.3503) [0.1 s] *
2025-12-12 18:47:33,737 - INFO - Epoch 8     loss=0.1583 [10.1 s]	dev=(NDCG@10:0.3504) [0.1 s] *
2025-12-12 18:47:44,300 - INFO - Epoch 9     loss=0.1578 [10.4 s]	dev=(NDCG@10:0.3520) [0.1 s] *
2025-12-12 18:47:54,535 - INFO - Epoch 10    loss=0.1578 [10.1 s]	dev=(NDCG@10:0.3533) [0.1 s] *
2025-12-12 18:48:05,142 - INFO - Epoch 11    loss=0.1568 [10.4 s]	dev=(NDCG@10:0.3537) [0.1 s] *
2025-12-12 18:48:15,791 - INFO - Epoch 12    loss=0.1560 [10.5 s]	dev=(NDCG@10:0.3536) [0.1 s]
2025-12-12 18:48:26,327 - INFO - Epoch 13    loss=0.1556 [10.4 s]	dev=(NDCG@10:0.3544) [0.1 s] *
2025-12-12 18:48:36,754 - INFO - Epoch 14    loss=0.1557 [10.3 s]	dev=(NDCG@10:0.3549) [0.1 s] *
2025-12-12 18:48:47,283 - INFO - Epoch 15    loss=0.1538 [10.4 s]	dev=(NDCG@10:0.3550) [0.1 s] *
2025-12-12 18:48:57,359 - INFO - Epoch 16    loss=0.1552 [9.9 s]	dev=(NDCG@10:0.3555) [0.1 s] *
2025-12-12 18:49:07,714 - INFO - Epoch 17    loss=0.1549 [10.2 s]	dev=(NDCG@10:0.3559) [0.1 s] *
2025-12-12 18:49:18,187 - INFO - Epoch 18    loss=0.1560 [10.3 s]	dev=(NDCG@10:0.3567) [0.1 s] *
2025-12-12 18:49:28,853 - INFO - Epoch 19    loss=0.1553 [10.6 s]	dev=(NDCG@10:0.3566) [0.1 s]
2025-12-12 18:49:39,338 - INFO - Epoch 20    loss=0.1542 [10.4 s]	dev=(NDCG@10:0.3560) [0.1 s]
2025-12-12 18:49:49,815 - INFO - Epoch 21    loss=0.1539 [10.4 s]	dev=(NDCG@10:0.3566) [0.1 s]
2025-12-12 18:50:00,227 - INFO - Epoch 22    loss=0.1527 [10.3 s]	dev=(NDCG@10:0.3566) [0.1 s]
2025-12-12 18:50:00,228 - INFO - Early stop at 22 based on dev result.
2025-12-12 18:50:00,228 - INFO - 
Best Iter(dev)=   18	 dev=(NDCG@10:0.3567) [231.9 s] 
2025-12-12 18:50:00,256 - INFO - Load model from /home/ReChorus/Lab/Lab1/models/BiGeaR_Stage2_with_distill.pt
2025-12-12 18:50:00,283 - INFO - Load model from /home/ReChorus/Lab/Lab1/models/BiGeaR_Stage2_with_distill.pt
2025-12-12 18:50:00,465 - INFO - 
训练完成 (with_distill)
2025-12-12 18:50:00,465 - INFO - 训练时间: 231.88s
2025-12-12 18:50:00,466 - INFO - Dev 结果: NDCG@5:0.3161,NDCG@10:0.3567,NDCG@20:0.3840,NDCG@50:0.4184
2025-12-12 18:50:00,466 - INFO - Test 结果: NDCG@5:0.2556,NDCG@10:0.2963,NDCG@20:0.3256,NDCG@50:0.3656
2025-12-12 18:50:00,476 - INFO - 
============================================================
2025-12-12 18:50:00,476 - INFO - Part 2: 训练无蒸馏版本 (use_distillation=False)
2025-12-12 18:50:00,476 - INFO - ============================================================
2025-12-12 18:50:00,476 - INFO - 
============================================================
2025-12-12 18:50:00,476 - INFO - 开始训练 Stage 2 (no_distill)
2025-12-12 18:50:00,476 - INFO - ============================================================
2025-12-12 18:50:06,865 - INFO - 模型参数量: 1497344
2025-12-12 18:50:06,865 - INFO - use_distillation = False
2025-12-12 18:50:07,132 - INFO - 训练前测试: (NDCG@5:0.2430,NDCG@10:0.2820,NDCG@20:0.3111,NDCG@50:0.3525)
2025-12-12 18:50:07,267 - INFO - Optimizer: Adam
2025-12-12 18:50:14,544 - INFO - Epoch 1     loss=0.1674 [7.3 s]	dev=(NDCG@10:0.3398) [0.1 s] *
2025-12-12 18:50:22,098 - INFO - Epoch 2     loss=0.1547 [7.4 s]	dev=(NDCG@10:0.3423) [0.1 s] *
2025-12-12 18:50:29,887 - INFO - Epoch 3     loss=0.1492 [7.7 s]	dev=(NDCG@10:0.3447) [0.1 s] *
2025-12-12 18:50:37,200 - INFO - Epoch 4     loss=0.1446 [7.2 s]	dev=(NDCG@10:0.3466) [0.1 s] *
2025-12-12 18:50:44,774 - INFO - Epoch 5     loss=0.1429 [7.5 s]	dev=(NDCG@10:0.3468) [0.1 s] *
2025-12-12 18:50:52,078 - INFO - Epoch 6     loss=0.1406 [7.2 s]	dev=(NDCG@10:0.3481) [0.1 s] *
2025-12-12 18:50:59,308 - INFO - Epoch 7     loss=0.1399 [7.1 s]	dev=(NDCG@10:0.3502) [0.1 s] *
2025-12-12 18:51:06,323 - INFO - Epoch 8     loss=0.1387 [6.9 s]	dev=(NDCG@10:0.3501) [0.1 s]
2025-12-12 18:51:11,815 - INFO - Epoch 9     loss=0.1382 [5.4 s]	dev=(NDCG@10:0.3498) [0.1 s]
2025-12-12 18:51:19,219 - INFO - Epoch 10    loss=0.1383 [7.3 s]	dev=(NDCG@10:0.3516) [0.1 s] *
2025-12-12 18:51:26,368 - INFO - Epoch 11    loss=0.1375 [7.0 s]	dev=(NDCG@10:0.3524) [0.1 s] *
2025-12-12 18:51:32,449 - INFO - Epoch 12    loss=0.1366 [6.0 s]	dev=(NDCG@10:0.3511) [0.1 s]
2025-12-12 18:51:39,957 - INFO - Epoch 13    loss=0.1364 [7.4 s]	dev=(NDCG@10:0.3517) [0.1 s]
2025-12-12 18:51:47,546 - INFO - Epoch 14    loss=0.1364 [7.5 s]	dev=(NDCG@10:0.3523) [0.1 s]
2025-12-12 18:51:54,924 - INFO - Epoch 15    loss=0.1348 [7.3 s]	dev=(NDCG@10:0.3527) [0.1 s] *
2025-12-12 18:52:02,206 - INFO - Epoch 16    loss=0.1357 [7.2 s]	dev=(NDCG@10:0.3526) [0.1 s]
2025-12-12 18:52:09,197 - INFO - Epoch 17    loss=0.1356 [6.9 s]	dev=(NDCG@10:0.3535) [0.1 s] *
2025-12-12 18:52:16,849 - INFO - Epoch 18    loss=0.1366 [7.5 s]	dev=(NDCG@10:0.3538) [0.1 s] *
2025-12-12 18:52:24,430 - INFO - Epoch 19    loss=0.1361 [7.4 s]	dev=(NDCG@10:0.3548) [0.1 s] *
2025-12-12 18:52:32,141 - INFO - Epoch 20    loss=0.1347 [7.6 s]	dev=(NDCG@10:0.3549) [0.1 s] *
2025-12-12 18:52:39,580 - INFO - Epoch 21    loss=0.1347 [7.3 s]	dev=(NDCG@10:0.3544) [0.1 s]
2025-12-12 18:52:47,105 - INFO - Epoch 22    loss=0.1335 [7.4 s]	dev=(NDCG@10:0.3547) [0.1 s]
2025-12-12 18:52:54,693 - INFO - Epoch 23    loss=0.1336 [7.5 s]	dev=(NDCG@10:0.3545) [0.1 s]
2025-12-12 18:53:02,069 - INFO - Epoch 24    loss=0.1339 [7.3 s]	dev=(NDCG@10:0.3544) [0.1 s]
2025-12-12 18:53:02,069 - INFO - Early stop at 24 based on dev result.
2025-12-12 18:53:02,069 - INFO - 
Best Iter(dev)=   20	 dev=(NDCG@10:0.3549) [174.9 s] 
2025-12-12 18:53:02,074 - INFO - Load model from /home/ReChorus/Lab/Lab1/models/BiGeaR_Stage2_no_distill.pt
2025-12-12 18:53:02,079 - INFO - Load model from /home/ReChorus/Lab/Lab1/models/BiGeaR_Stage2_no_distill.pt
2025-12-12 18:53:02,258 - INFO - 
训练完成 (no_distill)
2025-12-12 18:53:02,258 - INFO - 训练时间: 174.94s
2025-12-12 18:53:02,258 - INFO - Dev 结果: NDCG@5:0.3148,NDCG@10:0.3549,NDCG@20:0.3815,NDCG@50:0.4157
2025-12-12 18:53:02,258 - INFO - Test 结果: NDCG@5:0.2537,NDCG@10:0.2948,NDCG@20:0.3238,NDCG@50:0.3641
2025-12-12 18:53:02,266 - INFO - 
============================================================
2025-12-12 18:53:02,266 - INFO - 实验结果对比
2025-12-12 18:53:02,266 - INFO - ============================================================
2025-12-12 18:53:02,266 - INFO - 
测试集结果:
2025-12-12 18:53:02,266 - INFO - 模型                        | HR@10      | HR@20      | NDCG@10    | NDCG@20   
2025-12-12 18:53:02,266 - INFO - --------------------------------------------------------------------------------
2025-12-12 18:53:02,266 - INFO - BiGeaR (有蒸馏)              | 0.4936     | 0.6098     | 0.2963     | 0.3256    
2025-12-12 18:53:02,266 - INFO - BiGeaR (无蒸馏)              | 0.4913     | 0.6062     | 0.2948     | 0.3238    
2025-12-12 18:53:02,267 - INFO - 
相对变化 (无蒸馏 vs 有蒸馏):
2025-12-12 18:53:02,267 - INFO -   HR@10: -0.47%
2025-12-12 18:53:02,267 - INFO -   HR@20: -0.58%
2025-12-12 18:53:02,267 - INFO -   NDCG@10: -0.50%
2025-12-12 18:53:02,267 - INFO -   NDCG@20: -0.55%
2025-12-12 18:53:02,267 - INFO - 
结果已保存到: /home/ReChorus/Lab/Lab1/results/ablation_results_20251212_184600.json
2025-12-12 18:53:02,267 - INFO - 
实验一完成！
