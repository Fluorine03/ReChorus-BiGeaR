Namespace(model_name='BiGeaR_LightGCN_v2', model_mode='')
--------------------------------------------- BEGIN: 2025-12-12 11:08:07 ---------------------------------------------

===========================================
 Arguments          | Values               
===========================================
 batch_size         | 256                 
 data_appendix      |                     
 dataset            | Grocery_and_Gourm...
 dropout            | 0                   
 early_stop         | 10                  
 emb_size           | 64                  
 epoch              | 200                 
 eval_batch_size    | 256                 
 gpu                | 0                   
 l2                 | 1e-06               
 lambda_decay       | 0.1                 
 lambda_id          | 1.0                 
 lr                 | 0.001               
 main_metric        |                     
 n_layers           | 2                   
 norm_a             | 1.0                 
 num_neg            | 1                   
 num_workers        | 5                   
 optimizer          | Adam                
 random_seed        | 0                   
 save_final_results | 1                   
 stage              | 1                   
 teacher_model_path |                     
 test_all           | 0                   
 top_r              | 100                 
 topk               | 5,10,20,50          
===========================================
Device: cuda
Load corpus from data/Grocery_and_Gourmet_Food/BaseReader.pkl
#params: 1497344
BiGeaR_LightGCN_v2(
  (user_embedding): Embedding(14682, 64)
  (item_embedding): Embedding(8714, 64)
  (quant_layer): QuantLayer()
)
Test Before Training: (NDCG@5:0.0305,NDCG@10:0.0468,NDCG@20:0.0720,NDCG@50:0.1291)
Optimizer: Adam
Epoch 1     loss=0.4986 [7.3 s]	dev=(NDCG@5:0.1967) [0.3 s] *
Epoch 2     loss=0.3925 [6.3 s]	dev=(NDCG@5:0.2382) [0.3 s] *
Epoch 3     loss=0.3348 [6.4 s]	dev=(NDCG@5:0.2674) [0.3 s] *
Epoch 4     loss=0.2953 [6.3 s]	dev=(NDCG@5:0.2836) [0.3 s] *
Epoch 5     loss=0.2682 [6.4 s]	dev=(NDCG@5:0.2902) [0.3 s] *
Epoch 6     loss=0.2490 [6.5 s]	dev=(NDCG@5:0.2947) [0.3 s] *
Epoch 7     loss=0.2351 [6.5 s]	dev=(NDCG@5:0.2981) [0.3 s] *
Epoch 8     loss=0.2215 [6.1 s]	dev=(NDCG@5:0.3022) [0.3 s] *
Epoch 9     loss=0.2089 [6.3 s]	dev=(NDCG@5:0.3054) [0.3 s] *
Epoch 10    loss=0.1988 [6.3 s]	dev=(NDCG@5:0.3084) [0.3 s] *
Epoch 11    loss=0.1890 [6.2 s]	dev=(NDCG@5:0.3110) [0.3 s] *
Epoch 12    loss=0.1790 [6.3 s]	dev=(NDCG@5:0.3122) [0.3 s] *
Epoch 13    loss=0.1717 [6.2 s]	dev=(NDCG@5:0.3144) [0.4 s] *
Epoch 14    loss=0.1631 [6.4 s]	dev=(NDCG@5:0.3161) [0.3 s] *
Epoch 15    loss=0.1533 [6.3 s]	dev=(NDCG@5:0.3167) [0.3 s] *
Epoch 16    loss=0.1485 [6.3 s]	dev=(NDCG@5:0.3179) [0.3 s] *
Epoch 17    loss=0.1406 [6.0 s]	dev=(NDCG@5:0.3188) [0.3 s] *
Epoch 18    loss=0.1368 [6.2 s]	dev=(NDCG@5:0.3199) [0.3 s] *
Epoch 19    loss=0.1311 [6.4 s]	dev=(NDCG@5:0.3208) [0.3 s] *
Epoch 20    loss=0.1236 [6.3 s]	dev=(NDCG@5:0.3223) [0.3 s] *
Epoch 21    loss=0.1187 [6.4 s]	dev=(NDCG@5:0.3230) [0.3 s] *
Epoch 22    loss=0.1137 [6.5 s]	dev=(NDCG@5:0.3238) [0.3 s] *
Epoch 23    loss=0.1091 [6.4 s]	dev=(NDCG@5:0.3246) [0.3 s] *
Epoch 24    loss=0.1055 [6.4 s]	dev=(NDCG@5:0.3259) [0.3 s] *
Epoch 25    loss=0.1013 [6.3 s]	dev=(NDCG@5:0.3262) [0.3 s] *
Epoch 26    loss=0.0999 [6.5 s]	dev=(NDCG@5:0.3270) [0.3 s] *
Epoch 27    loss=0.0963 [6.4 s]	dev=(NDCG@5:0.3274) [0.3 s] *
Epoch 28    loss=0.0933 [6.2 s]	dev=(NDCG@5:0.3283) [0.3 s] *
Epoch 29    loss=0.0901 [6.4 s]	dev=(NDCG@5:0.3285) [0.3 s] *
Epoch 30    loss=0.0883 [6.4 s]	dev=(NDCG@5:0.3292) [0.3 s] *
Epoch 31    loss=0.0855 [6.4 s]	dev=(NDCG@5:0.3297) [0.3 s] *
Epoch 32    loss=0.0842 [6.3 s]	dev=(NDCG@5:0.3300) [0.3 s] *
Epoch 33    loss=0.0813 [6.1 s]	dev=(NDCG@5:0.3310) [0.3 s] *
Epoch 34    loss=0.0797 [6.2 s]	dev=(NDCG@5:0.3313) [0.4 s] *
Epoch 35    loss=0.0782 [6.2 s]	dev=(NDCG@5:0.3313) [0.3 s] *
Epoch 36    loss=0.0772 [6.2 s]	dev=(NDCG@5:0.3311) [0.3 s] *
Epoch 37    loss=0.0750 [6.3 s]	dev=(NDCG@5:0.3311) [0.3 s] *
Epoch 38    loss=0.0751 [6.1 s]	dev=(NDCG@5:0.3322) [0.3 s] *
Epoch 39    loss=0.0734 [6.4 s]	dev=(NDCG@5:0.3321) [0.3 s] *
Epoch 40    loss=0.0721 [6.3 s]	dev=(NDCG@5:0.3322) [0.3 s] *
Epoch 41    loss=0.0711 [6.5 s]	dev=(NDCG@5:0.3323) [0.3 s] *
Epoch 42    loss=0.0716 [6.3 s]	dev=(NDCG@5:0.3331) [0.3 s] *
Epoch 43    loss=0.0703 [6.3 s]	dev=(NDCG@5:0.3328) [0.3 s] *
Epoch 44    loss=0.0690 [5.9 s]	dev=(NDCG@5:0.3342) [0.3 s] *
Epoch 45    loss=0.0682 [6.2 s]	dev=(NDCG@5:0.3329) [0.3 s] *
Epoch 46    loss=0.0692 [6.3 s]	dev=(NDCG@5:0.3335) [0.3 s] *
Epoch 47    loss=0.0673 [6.3 s]	dev=(NDCG@5:0.3333) [0.3 s] *
Epoch 48    loss=0.0658 [6.4 s]	dev=(NDCG@5:0.3339) [0.3 s] *
Epoch 49    loss=0.0668 [6.2 s]	dev=(NDCG@5:0.3342) [0.3 s] *
Epoch 50    loss=0.0657 [6.4 s]	dev=(NDCG@5:0.3341) [0.3 s] *
Epoch 51    loss=0.0668 [6.2 s]	dev=(NDCG@5:0.3335) [0.3 s] *
Epoch 52    loss=0.0648 [6.0 s]	dev=(NDCG@5:0.3335) [0.3 s] *
Epoch 53    loss=0.0655 [6.3 s]	dev=(NDCG@5:0.3339) [0.3 s] *
Epoch 54    loss=0.0635 [6.2 s]	dev=(NDCG@5:0.3340) [0.3 s] *
Epoch 55    loss=0.0642 [6.2 s]	dev=(NDCG@5:0.3339) [0.3 s] *
Epoch 56    loss=0.0633 [6.2 s]	dev=(NDCG@5:0.3339) [0.3 s] *
Epoch 57    loss=0.0635 [6.1 s]	dev=(NDCG@5:0.3342) [0.3 s] *
Epoch 58    loss=0.0619 [6.3 s]	dev=(NDCG@5:0.3344) [0.3 s] *
Epoch 59    loss=0.0624 [6.3 s]	dev=(NDCG@5:0.3346) [0.3 s] *
Epoch 60    loss=0.0623 [6.4 s]	dev=(NDCG@5:0.3338) [0.3 s] *
Epoch 61    loss=0.0639 [6.2 s]	dev=(NDCG@5:0.3339) [0.3 s] *
Epoch 62    loss=0.0617 [6.5 s]	dev=(NDCG@5:0.3338) [0.3 s] *
Epoch 63    loss=0.0606 [6.4 s]	dev=(NDCG@5:0.3336) [0.3 s] *
Epoch 64    loss=0.0608 [6.3 s]	dev=(NDCG@5:0.3337) [0.3 s] *
Epoch 65    loss=0.0610 [6.2 s]	dev=(NDCG@5:0.3349) [0.3 s] *
Epoch 66    loss=0.0611 [6.3 s]	dev=(NDCG@5:0.3339) [0.4 s] *
Epoch 67    loss=0.0606 [6.4 s]	dev=(NDCG@5:0.3347) [0.3 s] *
Epoch 68    loss=0.0595 [6.3 s]	dev=(NDCG@5:0.3348) [0.3 s] *
Epoch 69    loss=0.0604 [6.2 s]	dev=(NDCG@5:0.3344) [0.3 s] *
Epoch 70    loss=0.0601 [6.4 s]	dev=(NDCG@5:0.3349) [0.3 s] *
Epoch 71    loss=0.0603 [5.6 s]	dev=(NDCG@5:0.3343) [0.3 s] *
Epoch 72    loss=0.0599 [5.9 s]	dev=(NDCG@5:0.3342) [0.3 s] *
Epoch 73    loss=0.0603 [6.1 s]	dev=(NDCG@5:0.3346) [0.4 s] *
Epoch 74    loss=0.0591 [5.4 s]	dev=(NDCG@5:0.3346) [0.3 s] *
Early stop at 74 based on dev result.

Best Iter(dev)=   65	 dev=(NDCG@5:0.3349) [488.8 s] 
Load model from /home/ReChorus/record/BiGeaR_LightGCN_v2/controlled_stage1_models/BiGeaR_LightGCN_v2__Grocery_and_Gourmet_Food__seed0__lr=0.001__l2=1e-06__emb_size=64__n_layers=2__stage=1.pt

Dev  After Training: (NDCG@5:0.3346,NDCG@10:0.3712,NDCG@20:0.3975,NDCG@50:0.4320)

Test After Training: (NDCG@5:0.2730,NDCG@10:0.3114,NDCG@20:0.3404,NDCG@50:0.3797)
Saving top-100 recommendation results to: ../log/BiGeaR_LightGCN_v2/BiGeaR_LightGCN_v2__Grocery_and_Gourmet_Food__0__lr=0/rec-BiGeaR_LightGCN_v2-dev.csv
dev Prediction results saved!
Saving top-100 recommendation results to: ../log/BiGeaR_LightGCN_v2/BiGeaR_LightGCN_v2__Grocery_and_Gourmet_Food__0__lr=0/rec-BiGeaR_LightGCN_v2-test.csv
test Prediction results saved!

--------------------------------------------- END: 2025-12-12 11:16:28 ---------------------------------------------
